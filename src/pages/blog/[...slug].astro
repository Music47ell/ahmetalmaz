---
import ContentLayout from "../../layouts/ContentLayout.astro";
import { fetchPublicPostBySlug } from "../../libs/fetchWP";
import { processPostContent } from "../../libs/processPost";

const { slug } = Astro.params;

const post = await fetchPublicPostBySlug(slug);

if (!post) return Astro.redirect("/404");

const content = await processPostContent(post.content.markdown);
---

<ContentLayout
	title={post.title.rendered}
	description={post.excerpt.markdown}
	published_at={post.date}
	lastModified={post.modified}
	readingTime={post.readingTime}
	wordsCount={post.wordCount}
	slug={post.slug}
	mastodon_status={post.mastodon_status}
>
	<div set:html={content} />
</ContentLayout>